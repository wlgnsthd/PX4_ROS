# Custom OBJ detection with Yolov3
## Ultralytics 
##### https://medium.com/analytics-vidhya/custom-object-detection-with-yolov3-8f72fe8ced79
```
git clone https://github.com/TheCaffeineDev/YoloV3-Custom-Object-Detection.git
```
```
main_folder
│   - detect.py
│   - models.py
│   - train.py*******
│  - test.py
│  - requirements.txt
│  ...
└─── cfg
└─── conversion
    │
    └─── output***
    └─── xmls*
    │  - classes.txt**
    │  - xmltotxt.py
    │  ...
└─── data
└─── training
│ │
│ └─── images*
│ └─── labels***
│ - object.names****
│ - trainer.data*****
│ - yolov3.cfg******
│ - train_test.py*****
│
└─── utils
└─── weights
```
```
pip3 install -r requirements.txt
```
### put images and xmls to the folders & edit classes.txt
```
# In YoloV3-Custom-Object-Detection/conversion folder
python3 xmltotxt.py -xml xmls -out output
```
### move txt file to label folder & edit object.names putting my classes
```
# In YoloV3-Custom-Object-Detection/training folder
python3 train_test.py
```
### edit trainer.data , classes number, train test txt path, object.names path
### edit cfg file 
#### classes = n, filter = (4+1+n)x3 , no_6_7_610_603_689_696_776_783 in yolov3.cfg
##### (default layer 255 output, 85 output per anchor(4box coord+1 obj conf+80 class conf) x3)
_________________________
### Training model
```
# In YoloV3-Custom-Object-Detection run
python3 train.py --epochs 110 --data training/trainer.data --cfg training/yolov3.cfg --batch 16 --accum 1
```
### In YoloV3-Custom-Object-Detection do in terminal
```
tensorboard --logdir=runs
```
__________________________
### Exporting weights file
#### do it in terminal
```
# convert cfg/pytorch model to darknet weights
# In YoloV3-Custom-Object-Detection
python3  -c "from models import *; convert('training/yolov3.cfg', 'weights/best.pt')"
```
### Testing
```
# In YoloV3-Custom-Object-Detection - for webcam
python3 detect.py --source 0 --weights converted.weights --cfg training/yolov3.cfg --names training/object.names --img-size 416
```
